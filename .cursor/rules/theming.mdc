---
description: Theming system rules and CSS variable guidelines
globs: ["packages/ui-tw/**/*", "**/*.css", "**/*.scss"]
alwaysApply: false
---

# Theming System Rules

## 🎨 CSS Variable Structure

### Color System
All colors must use HSL format and follow the semantic naming convention:

```css
[data-theme="nostromo"] {
  /* Brand colors - primary brand identity */
  --color-brand-50: 262 84% 95%;
  --color-brand-100: 262 84% 90%;
  --color-brand-200: 262 84% 80%;
  --color-brand-300: 262 84% 70%;
  --color-brand-400: 262 84% 60%;
  --color-brand-500: 262 84% 52%;  /* Primary brand color */
  --color-brand-600: 262 84% 45%;
  --color-brand-700: 262 84% 35%;
  --color-brand-800: 262 84% 25%;
  --color-brand-900: 262 84% 15%;
  --color-brand-950: 262 84% 8%;

  /* Neutral colors - grays and text */
  --color-neutral-50: 0 0% 98%;
  --color-neutral-100: 0 0% 96%;
  --color-neutral-200: 0 0% 90%;
  --color-neutral-300: 0 0% 83%;
  --color-neutral-400: 0 0% 64%;
  --color-neutral-500: 0 0% 45%;
  --color-neutral-600: 0 0% 32%;
  --color-neutral-700: 0 0% 25%;
  --color-neutral-800: 0 0% 15%;
  --color-neutral-900: 0 0% 9%;
  --color-neutral-950: 0 0% 4%;

  /* Semantic colors */
  --color-success-500: 142 76% 36%;
  --color-warning-500: 38 92% 50%;
  --color-error-500: 0 84% 60%;
  --color-info-500: 199 89% 48%;
}
```

### Spacing & Sizing
```css
[data-theme="nostromo"] {
  /* Spacing scale - based on 4px grid */
  --spacing-xs: 0.25rem;   /* 4px */
  --spacing-sm: 0.5rem;    /* 8px */
  --spacing-md: 1rem;      /* 16px */
  --spacing-lg: 1.5rem;    /* 24px */
  --spacing-xl: 2rem;      /* 32px */
  --spacing-2xl: 3rem;     /* 48px */
  --spacing-3xl: 4rem;     /* 64px */

  /* Border radius */
  --radius-none: 0px;
  --radius-sm: 0.25rem;    /* 4px */
  --radius-md: 0.5rem;     /* 8px */
  --radius-lg: 0.75rem;    /* 12px */
  --radius-xl: 1rem;       /* 16px */
  --radius-full: 9999px;

  /* Shadows */
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
  --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
}
```

### Typography
```css
[data-theme="nostromo"] {
  /* Font families */
  --font-heading: "Inter", system-ui, sans-serif;
  --font-body: "Inter", system-ui, sans-serif;
  --font-mono: "JetBrains Mono", "Fira Code", monospace;

  /* Font sizes */
  --text-xs: 0.75rem;      /* 12px */
  --text-sm: 0.875rem;     /* 14px */
  --text-base: 1rem;       /* 16px */
  --text-lg: 1.125rem;     /* 18px */
  --text-xl: 1.25rem;      /* 20px */
  --text-2xl: 1.5rem;      /* 24px */
  --text-3xl: 1.875rem;    /* 30px */
  --text-4xl: 2.25rem;     /* 36px */
  --text-5xl: 3rem;        /* 48px */

  /* Line heights */
  --leading-tight: 1.25;
  --leading-normal: 1.5;
  --leading-relaxed: 1.75;

  /* Font weights */
  --font-normal: 400;
  --font-medium: 500;
  --font-semibold: 600;
  --font-bold: 700;
}
```

## 🎭 Theme Implementation

### Theme Structure
```css
/* Base theme - always applied */
[data-theme="nostromo"] {
  /* All CSS variables defined here */
}

/* Dark mode variant */
[data-theme="nostromo"][data-color-scheme="dark"] {
  --color-neutral-50: 0 0% 9%;
  --color-neutral-900: 0 0% 98%;
  /* Override other colors as needed */
}

/* System preference */
@media (prefers-color-scheme: dark) {
  [data-theme="nostromo"] {
    --color-neutral-50: 0 0% 9%;
    --color-neutral-900: 0 0% 98%;
  }
}
```

### Custom Theme Creation
```css
/* User-defined custom theme */
[data-theme="mybrand"] {
  /* Brand colors */
  --color-brand-500: 262 84% 52%;
  --color-brand-600: 262 84% 45%;
  --color-brand-700: 262 84% 35%;

  /* Neutral colors */
  --color-neutral-50: 0 0% 98%;
  --color-neutral-900: 0 0% 9%;

  /* Custom styling */
  --radius-md: 0.75rem;
  --font-heading: "Poppins", sans-serif;
  --font-body: "Inter", sans-serif;
}
```

## 🎨 Tailwind Integration

### Preset Configuration
```js
// tailwind.preset.js
module.exports = {
  theme: {
    extend: {
      colors: {
        brand: {
          50: "hsl(var(--color-brand-50))",
          100: "hsl(var(--color-brand-100))",
          // ... all brand colors
          950: "hsl(var(--color-brand-950))",
        },
        neutral: {
          50: "hsl(var(--color-neutral-50))",
          // ... all neutral colors
          950: "hsl(var(--color-neutral-950))",
        },
        success: {
          500: "hsl(var(--color-success-500))",
        },
        warning: {
          500: "hsl(var(--color-warning-500))",
        },
        error: {
          500: "hsl(var(--color-error-500))",
        },
        info: {
          500: "hsl(var(--color-info-500))",
        },
      },
      borderRadius: {
        sm: "var(--radius-sm)",
        md: "var(--radius-md)",
        lg: "var(--radius-lg)",
        xl: "var(--radius-xl)",
        full: "var(--radius-full)",
      },
      fontFamily: {
        heading: "var(--font-heading)",
        body: "var(--font-body)",
        mono: "var(--font-mono)",
      },
      fontSize: {
        xs: "var(--text-xs)",
        sm: "var(--text-sm)",
        base: "var(--text-base)",
        lg: "var(--text-lg)",
        xl: "var(--text-xl)",
        "2xl": "var(--text-2xl)",
        "3xl": "var(--text-3xl)",
        "4xl": "var(--text-4xl)",
        "5xl": "var(--text-5xl)",
      },
      lineHeight: {
        tight: "var(--leading-tight)",
        normal: "var(--leading-normal)",
        relaxed: "var(--leading-relaxed)",
      },
      fontWeight: {
        normal: "var(--font-normal)",
        medium: "var(--font-medium)",
        semibold: "var(--font-semibold)",
        bold: "var(--font-bold)",
      },
      boxShadow: {
        sm: "var(--shadow-sm)",
        md: "var(--shadow-md)",
        lg: "var(--shadow-lg)",
        xl: "var(--shadow-xl)",
      },
    },
  },
};
```

## 🚫 Theming Anti-Patterns

### ❌ Don't Do This
```css
/* Wrong - hardcoded colors */
.button {
  background-color: #8b5cf6;
  color: white;
}

/* Wrong - RGB instead of HSL */
:root {
  --color-primary: 139 92 246;
}

/* Wrong - inconsistent naming */
:root {
  --primary-color: 262 84% 52%;
  --secondaryColor: 0 0% 45%;
}
```

### ✅ Do This Instead
```css
/* Correct - using CSS variables */
.button {
  background-color: hsl(var(--color-brand-500));
  color: hsl(var(--color-neutral-50));
}

/* Correct - HSL format */
:root {
  --color-brand-500: 262 84% 52%;
}

/* Correct - consistent naming */
:root {
  --color-brand-500: 262 84% 52%;
  --color-neutral-500: 0 0% 45%;
}
```

## 🌙 Dark Mode Implementation

### Manual Dark Mode
```tsx
// React hook for dark mode
function useDarkMode() {
  const [isDark, setIsDark] = useState(false);
  
  useEffect(() => {
    const root = document.documentElement;
    root.setAttribute('data-color-scheme', isDark ? 'dark' : 'light');
  }, [isDark]);
  
  return [isDark, setIsDark];
}
```

### System Preference
```css
/* Automatic dark mode based on system preference */
@media (prefers-color-scheme: dark) {
  [data-theme="nostromo"] {
    --color-neutral-50: 0 0% 9%;
    --color-neutral-100: 0 0% 15%;
    --color-neutral-200: 0 0% 25%;
    --color-neutral-300: 0 0% 35%;
    --color-neutral-400: 0 0% 45%;
    --color-neutral-500: 0 0% 55%;
    --color-neutral-600: 0 0% 65%;
    --color-neutral-700: 0 0% 75%;
    --color-neutral-800: 0 0% 85%;
    --color-neutral-900: 0 0% 95%;
    --color-neutral-950: 0 0% 98%;
  }
}
```

## 🎯 Theme Validation

### Color Contrast
Ensure all color combinations meet WCAG 2.1 AA standards:
- **Normal text**: 4.5:1 contrast ratio
- **Large text**: 3:1 contrast ratio
- **UI components**: 3:1 contrast ratio

### Color Palette Testing
```css
/* Test color combinations */
.test-contrast {
  /* Primary text on light background */
  color: hsl(var(--color-neutral-900));
  background-color: hsl(var(--color-neutral-50));
  
  /* Primary text on dark background */
  color: hsl(var(--color-neutral-50));
  background-color: hsl(var(--color-neutral-900));
  
  /* Brand text on light background */
  color: hsl(var(--color-brand-600));
  background-color: hsl(var(--color-neutral-50));
}
```

## 📱 Responsive Theming

### Breakpoint-Specific Variables
```css
[data-theme="nostromo"] {
  /* Mobile-first approach */
  --spacing-section: var(--spacing-lg);
  --text-hero: var(--text-3xl);
  
  /* Tablet and up */
  @media (min-width: 768px) {
    --spacing-section: var(--spacing-2xl);
    --text-hero: var(--text-4xl);
  }
  
  /* Desktop and up */
  @media (min-width: 1024px) {
    --spacing-section: var(--spacing-3xl);
    --text-hero: var(--text-5xl);
  }
}
```

## 🔧 Theme Utilities

### CSS Custom Properties
```css
/* Utility classes for common patterns */
.text-brand {
  color: hsl(var(--color-brand-500));
}

.bg-brand {
  background-color: hsl(var(--color-brand-500));
}

.border-brand {
  border-color: hsl(var(--color-brand-500));
}

.rounded-theme {
  border-radius: var(--radius-md);
}

.font-heading {
  font-family: var(--font-heading);
}

.font-body {
  font-family: var(--font-body);
}
```

---

**Remember**: All theming should be consistent, accessible, and follow the established patterns. When creating new themes, always test color contrast and ensure compatibility with both light and dark modes.